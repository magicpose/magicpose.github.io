<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>第 1 页 | Pivot&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta name="description" content="善人同处，则日闻嘉训；恶人从游，则日生邪情">
<meta property="og:type" content="website">
<meta property="og:title" content="Pivot&#39;s Blog">
<meta property="og:url" content="http://blog.magicpose.com/index.html">
<meta property="og:site_name" content="Pivot&#39;s Blog">
<meta property="og:description" content="善人同处，则日闻嘉训；恶人从游，则日生邪情">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Pivot&#39;s Blog">
<meta name="twitter:description" content="善人同处，则日闻嘉训；恶人从游，则日生邪情">
  
    <link rel="alternate" href="/atom.xml" title="Pivot&#39;s Blog" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >
  <link rel="stylesheet" href="/css/fashion.css" >
  <link rel="stylesheet" href="/css/glyphs.css" >

</head>



  <body>


	<!-- layout.ejs是主文件, 作者：pivot,时间：2017-09-21,描述：在此处才能判断编译路径 -->
	
  	


<header id="allheader" class="site-header" role="banner" 
   >
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="Pivot&#39;s Blog" rel="home"> Pivot&#39;s Blog </a>
            
          </h1>
          
          
            <div class="site-description">善人同处，则日闻嘉训；恶人从游，则日生邪情</div>
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows"  style="touch-action: pan-y;">
                    
                      <li data-desc="/" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">首页</a> </li>
                    
                      <li data-desc="archives" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">归档</a> </li>
                    
                      <li data-desc="categories" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/categories">分类</a> </li>
                    
                      <li data-desc="tags" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/tags">标签</a> </li>
                    
                      <li data-desc="about" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about">关于</a> </li>
                    
              </ul>
            </div>
          </nav>

      </div>
  </div>
</header>

  
  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main">
  
    <!--
	作者：646759661@qq.com
	时间：2017-10-25
	描述：width: 66%; 变更为 width: 100%;
-->
<article id="post-jvm/reprint_jstack"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/11/16/jvm/reprint_jstack/">Java jstack 用法</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/11/16/jvm/reprint_jstack/" class="article-date">
	  <time datetime="2017-11-16T03:56:13.318Z" itemprop="datePublished">十一月 16, 2017</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>jstack是jdk中自带的用于查看进程内线程栈的工具。当程序出现死锁时，我们可以通过jstack打印线程栈找到问题。</p>
<h3 id="找出代码中的死锁"><a href="#找出代码中的死锁" class="headerlink" title="找出代码中的死锁"></a>找出代码中的死锁</h3><p>学习从一段简单的代码开始:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">public class Main &#123;</div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        test1();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private static void test1() &#123;</div><div class="line">        final Object lock1 = new Object();</div><div class="line">        final Object lock2 = new Object();</div><div class="line">        Thread thread=new Thread(new Runnable() &#123;</div><div class="line">            public void run() &#123;</div><div class="line">                synchronized (lock1) &#123;</div><div class="line">                    try &#123;</div><div class="line">                        for(int i=0;i&lt;20;i++) &#123;</div><div class="line">                            Thread.sleep(1000);</div><div class="line">                            System.out.println(Thread.currentThread().getName()+&quot; &quot;+i);</div><div class="line">                        &#125;</div><div class="line">                        synchronized (lock2) &#123;</div><div class="line">                            for(int i=20;i&lt;40;i++) &#123;</div><div class="line">                                Thread.sleep(1000);</div><div class="line">                                System.out.println(Thread.currentThread().getName()+&quot; &quot;+i);</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                    &#125; catch (InterruptedException e) &#123;</div><div class="line">                        e.printStackTrace();</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        thread.start();</div><div class="line">        synchronized (lock2) &#123;</div><div class="line">            try &#123;</div><div class="line">                for(int i=0;i&lt;20;i++) &#123;</div><div class="line">                    Thread.sleep(1000);</div><div class="line">                    System.out.println(Thread.currentThread().getName()+&quot; &quot;+i);</div><div class="line">                &#125;</div><div class="line">                synchronized (lock1) &#123;</div><div class="line">                    for(int i=20;i&lt;40;i++) &#123;</div><div class="line">                        Thread.sleep(1000);</div><div class="line">                        System.out.println(Thread.currentThread().getName()+&quot; &quot;+i);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">            &#125; catch (InterruptedException e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>肉眼都能看出来的死锁，程序运行20s后进入死锁状态。<br>首先我们先找出这个程序的进程id,建议用jps,而不是ps,原因是jps只会显示当前用户下面的java进程，等于自动帮我们过滤了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">jps -l</div><div class="line"></div><div class="line">$ jps</div><div class="line">8896 Bootstrap</div><div class="line">3941 Bootstrap</div><div class="line">11718 Jps</div><div class="line">9711 Bootstrap</div></pre></td></tr></table></figure></p>
<p>jstack 显示堆栈信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div></pre></td><td class="code"><pre><div class="line">$ jstack 9711</div><div class="line"></div><div class="line">2017-05-23 13:57:22</div><div class="line">Full thread dump Java HotSpot(TM) 64-Bit Server VM (25.45-b02 mixed mode):</div><div class="line"></div><div class="line">&quot;Attach Listener&quot; #12 daemon prio=9 os_prio=31 tid=0x00007ff0f780c800 nid=0x4507 waiting on condition [0x0000000000000000]</div><div class="line">   java.lang.Thread.State: RUNNABLE</div><div class="line"></div><div class="line">&quot;Thread-0&quot; #11 prio=5 os_prio=31 tid=0x00007ff0f80c0000 nid=0x5a03 waiting for monitor entry [0x0000700002310000]</div><div class="line">   java.lang.Thread.State: BLOCKED (on object monitor)</div><div class="line">    at Main$1.run(Main.java:33)</div><div class="line">    - waiting to lock &lt;0x000000076adb1a98&gt; (a java.lang.Object)</div><div class="line">    - locked &lt;0x000000076adb1a88&gt; (a java.lang.Object)</div><div class="line">    at java.lang.Thread.run(Thread.java:745)</div><div class="line"></div><div class="line">&quot;Service Thread&quot; #10 daemon prio=9 os_prio=31 tid=0x00007ff0f980b800 nid=0x5603 runnable [0x0000000000000000]</div><div class="line">   java.lang.Thread.State: RUNNABLE</div><div class="line"></div><div class="line">&quot;C1 CompilerThread3&quot; #9 daemon prio=9 os_prio=31 tid=0x00007ff0f6803000 nid=0x5403 waiting on condition [0x0000000000000000]</div><div class="line">   java.lang.Thread.State: RUNNABLE</div><div class="line"></div><div class="line">&quot;C2 CompilerThread2&quot; #8 daemon prio=9 os_prio=31 tid=0x00007ff0f6802800 nid=0x5203 waiting on condition [0x0000000000000000]</div><div class="line">   java.lang.Thread.State: RUNNABLE</div><div class="line"></div><div class="line">&quot;C2 CompilerThread1&quot; #7 daemon prio=9 os_prio=31 tid=0x00007ff0f6801800 nid=0x5003 waiting on condition [0x0000000000000000]</div><div class="line">   java.lang.Thread.State: RUNNABLE</div><div class="line"></div><div class="line">&quot;C2 CompilerThread0&quot; #6 daemon prio=9 os_prio=31 tid=0x00007ff0f90de800 nid=0x4e03 waiting on condition [0x0000000000000000]</div><div class="line">   java.lang.Thread.State: RUNNABLE</div><div class="line"></div><div class="line">&quot;Monitor Ctrl-Break&quot; #5 daemon prio=5 os_prio=31 tid=0x00007ff0f90dc800 nid=0x4c03 runnable [0x0000700001bfb000]</div><div class="line">   java.lang.Thread.State: RUNNABLE</div><div class="line">    at java.net.SocketInputStream.socketRead0(Native Method)</div><div class="line">    at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)</div><div class="line">    at java.net.SocketInputStream.read(SocketInputStream.java:170)</div><div class="line">    at java.net.SocketInputStream.read(SocketInputStream.java:141)</div><div class="line">    at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)</div><div class="line">    at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)</div><div class="line">    at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)</div><div class="line">    - locked &lt;0x000000076af12b68&gt; (a java.io.InputStreamReader)</div><div class="line">    at java.io.InputStreamReader.read(InputStreamReader.java:184)</div><div class="line">    at java.io.BufferedReader.fill(BufferedReader.java:161)</div><div class="line">    at java.io.BufferedReader.readLine(BufferedReader.java:324)</div><div class="line">    - locked &lt;0x000000076af12b68&gt; (a java.io.InputStreamReader)</div><div class="line">    at java.io.BufferedReader.readLine(BufferedReader.java:389)</div><div class="line">    at com.intellij.rt.execution.application.AppMainV2$1.run(AppMainV2.java:64)</div><div class="line"></div><div class="line">&quot;Signal Dispatcher&quot; #4 daemon prio=9 os_prio=31 tid=0x00007ff0f8039800 nid=0x4a03 runnable [0x0000000000000000]</div><div class="line">   java.lang.Thread.State: RUNNABLE</div><div class="line"></div><div class="line">&quot;Finalizer&quot; #3 daemon prio=8 os_prio=31 tid=0x00007ff0f9803000 nid=0x3903 in Object.wait() [0x0000700001972000]</div><div class="line">   java.lang.Thread.State: WAITING (on object monitor)</div><div class="line">    at java.lang.Object.wait(Native Method)</div><div class="line">    - waiting on &lt;0x000000076ab06f58&gt; (a java.lang.ref.ReferenceQueue$Lock)</div><div class="line">    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:143)</div><div class="line">    - locked &lt;0x000000076ab06f58&gt; (a java.lang.ref.ReferenceQueue$Lock)</div><div class="line">    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:164)</div><div class="line">    at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:209)</div><div class="line"></div><div class="line">&quot;Reference Handler&quot; #2 daemon prio=10 os_prio=31 tid=0x00007ff0f9802000 nid=0x3703 in Object.wait() [0x000070000186f000]</div><div class="line">   java.lang.Thread.State: WAITING (on object monitor)</div><div class="line">    at java.lang.Object.wait(Native Method)</div><div class="line">    - waiting on &lt;0x000000076ab06998&gt; (a java.lang.ref.Reference$Lock)</div><div class="line">    at java.lang.Object.wait(Object.java:502)</div><div class="line">    at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:157)</div><div class="line">    - locked &lt;0x000000076ab06998&gt; (a java.lang.ref.Reference$Lock)</div><div class="line"></div><div class="line">&quot;main&quot; #1 prio=5 os_prio=31 tid=0x00007ff0f8002000 nid=0x1c03 waiting for monitor entry [0x0000700000e51000]</div><div class="line">   java.lang.Thread.State: BLOCKED (on object monitor)</div><div class="line">    at Main.test1(Main.java:52)</div><div class="line">    - waiting to lock &lt;0x000000076adb1a88&gt; (a java.lang.Object)</div><div class="line">    - locked &lt;0x000000076adb1a98&gt; (a java.lang.Object)</div><div class="line">    at Main.main(Main.java:18)</div><div class="line"></div><div class="line">&quot;VM Thread&quot; os_prio=31 tid=0x00007ff0f801f800 nid=0x3503 runnable</div><div class="line"></div><div class="line">&quot;GC task thread#0 (ParallelGC)&quot; os_prio=31 tid=0x00007ff0f9003800 nid=0x2503 runnable</div><div class="line"></div><div class="line">&quot;GC task thread#1 (ParallelGC)&quot; os_prio=31 tid=0x00007ff0f9004000 nid=0x2703 runnable</div><div class="line"></div><div class="line">&quot;GC task thread#2 (ParallelGC)&quot; os_prio=31 tid=0x00007ff0f7801000 nid=0x2903 runnable</div><div class="line"></div><div class="line">&quot;GC task thread#3 (ParallelGC)&quot; os_prio=31 tid=0x00007ff0f600e800 nid=0x2b03 runnable</div><div class="line"></div><div class="line">&quot;GC task thread#4 (ParallelGC)&quot; os_prio=31 tid=0x00007ff0f600f000 nid=0x2d03 runnable</div><div class="line"></div><div class="line">&quot;GC task thread#5 (ParallelGC)&quot; os_prio=31 tid=0x00007ff0f6010000 nid=0x2f03 runnable</div><div class="line"></div><div class="line">&quot;GC task thread#6 (ParallelGC)&quot; os_prio=31 tid=0x00007ff0f6010800 nid=0x3103 runnable</div><div class="line"></div><div class="line">&quot;GC task thread#7 (ParallelGC)&quot; os_prio=31 tid=0x00007ff0f6011000 nid=0x3303 runnable</div><div class="line"></div><div class="line">&quot;VM Periodic Task Thread&quot; os_prio=31 tid=0x00007ff0f980c000 nid=0x5803 waiting on condition</div><div class="line"></div><div class="line">JNI global references: 26</div><div class="line"></div><div class="line"></div><div class="line">Found one Java-level deadlock:</div><div class="line">=============================</div><div class="line">&quot;Thread-0&quot;:</div><div class="line">  waiting to lock monitor 0x00007ff0f8024f38 (object 0x000000076adb1a98, a java.lang.Object),</div><div class="line">  which is held by &quot;main&quot;</div><div class="line">&quot;main&quot;:</div><div class="line">  waiting to lock monitor 0x00007ff0f8023bf8 (object 0x000000076adb1a88, a java.lang.Object),</div><div class="line">  which is held by &quot;Thread-0&quot;</div><div class="line"></div><div class="line">Java stack information for the threads listed above:</div><div class="line">===================================================</div><div class="line">&quot;Thread-0&quot;:</div><div class="line">    at Main$1.run(Main.java:33)</div><div class="line">    - waiting to lock &lt;0x000000076adb1a98&gt; (a java.lang.Object)</div><div class="line">    - locked &lt;0x000000076adb1a88&gt; (a java.lang.Object)</div><div class="line">    at java.lang.Thread.run(Thread.java:745)</div><div class="line">&quot;main&quot;:</div><div class="line">    at Main.test1(Main.java:52)</div><div class="line">    - waiting to lock &lt;0x000000076adb1a88&gt; (a java.lang.Object)</div><div class="line">    - locked &lt;0x000000076adb1a98&gt; (a java.lang.Object)</div><div class="line">    at Main.main(Main.java:18)</div><div class="line"></div><div class="line">Found 1 deadlock.</div></pre></td></tr></table></figure></p>
<p>jstack直接帮我们找出来了deadlock。真实场景下，如果代码比较复杂，可能需要我们自己分析找出死锁。<br>如果我们自己分析，该怎么找出死锁呢？重点分析java.lang.Thread.State: BLOCKED的进程，找到<br>waiting to lock，看看这个锁的持有者，是不是也被锁着，沿着这个链路找下去，是不是死锁就能找出来 了。比如上面的例子中,main线程持有0x000000076adb1a98锁，等待0x000000076adb1a88锁释放，而Thread-0持有0x000000076adb1a88锁，等待0x000000076adb1a98锁释放，两个线程互相等待，而进入死锁状态。</p>
<h3 id="找出CPU消耗多的代码"><a href="#找出CPU消耗多的代码" class="headerlink" title="找出CPU消耗多的代码"></a>找出CPU消耗多的代码</h3><p>如果程序cpu占用很高，我们需要找到问题优化，可以配合top命令，找出最耗cpu的进程，从而找到相应代码解决问题。</p>
<ul>
<li><p>先用jps找出程序pid，这里是23034</p>
</li>
<li><p>用top命令找出该进程最耗cpu的线程。下面的top是linux中的，mac里的不一样。</p>
<blockquote>
<p><code>top -Hp 9711</code><br><img src="http://blog.magicpose.com/img/jstack-01.png" alt="top -Hp &lt;pid&gt;"></p>
</blockquote>
</li>
<li><p>查看占用CPU较高的PID,并将其转化为16进制<br>因为top里的pid是10进制，而jstack里是16进制，叫nid。<br>可以用printf命令转换</p>
<blockquote>
<p><code>printf &quot;%x\n&quot; &lt;pid&gt;</code> 得到16进制PID</p>
</blockquote>
</li>
<li><p>jstack出场</p>
<blockquote>
<p><code>jstack 23034 | grep 16进制PID</code> 查看并分析结果找出问题</p>
</blockquote>
</li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JVM/">JVM</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <!--
	作者：646759661@qq.com
	时间：2017-10-25
	描述：width: 66%; 变更为 width: 100%;
-->
<article id="post-English/directory"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/11/13/English/directory/">专业名词解释 1</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/11/13/English/directory/" class="article-date">
	  <time datetime="2017-11-13T03:16:25.043Z" itemprop="datePublished">十一月 13, 2017</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="网站访问量"><a href="#网站访问量" class="headerlink" title="网站访问量"></a>网站访问量</h2><p>DAU: Daily Active User  日活跃用户</p>
<p>UV: Unique Visitor 独立游客</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/English/">English</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <!--
	作者：646759661@qq.com
	时间：2017-10-25
	描述：width: 66%; 变更为 width: 100%;
-->
<article id="post-h2/install h2"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/11/11/h2/install h2/">H2 数据库安装</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/11/11/h2/install h2/" class="article-date">
	  <time datetime="2017-11-11T10:00:11.484Z" itemprop="datePublished">十一月 11, 2017</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><a href="http://www.h2database.com" target="_blank" rel="external">H2官方站点</a></p>
<h3 id="安装JAVA环境-设置JAVA-HOME-CLASSPATH"><a href="#安装JAVA环境-设置JAVA-HOME-CLASSPATH" class="headerlink" title="安装JAVA环境,设置JAVA_HOME,CLASSPATH"></a>安装JAVA环境,设置JAVA_HOME,CLASSPATH</h3><p>下载安装不多说<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># linux下设置java环境变量</span></div><div class="line">vim /etc/profile</div><div class="line"></div><div class="line"><span class="built_in">export</span> JAVA_HOME=/opt/java/jdk1.8.0_151</div><div class="line"><span class="built_in">export</span> JAVA_BIN=<span class="variable">$JAVA_HOME</span>/bin</div><div class="line"><span class="built_in">export</span> CLASSPATH=.:<span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib/tools.jar</div><div class="line"><span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$PATH</span></div><div class="line"></div><div class="line"><span class="comment"># 使设置生效</span></div><div class="line"><span class="built_in">source</span> /etc/profile</div></pre></td></tr></table></figure></p>
<h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>下载H2压缩包,解压,进入目录,<code>build.bat</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd bin</div><div class="line"># 运行 h2.bat</div><div class="line">h2.bat</div></pre></td></tr></table></figure></p>
<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><p>下载H2压缩包,解压,进入目录,<code>./build.sh</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd bin</div><div class="line"># 运行 h2.sh &amp;</div><div class="line">./h2.sh &amp;</div></pre></td></tr></table></figure></p>
<h3 id="启动配置-h2-server-properties"><a href="#启动配置-h2-server-properties" class="headerlink" title="启动配置 .h2.server.properties"></a>启动配置 <code>.h2.server.properties</code></h3><p>默认启动只允许本机访问,需要设置一个属性<code>webAllowOthers=true</code>.这个在windows下面启动之后有个配置页面可以进行配置<br><img src="http://blog.magicpose.com/img/h2/h2-01.png" alt="H2管理登录界面"><br><img src="http://blog.magicpose.com/img/h2/h2-02.png" alt="H2管理自定义设置界面"></p>
<p>Linux下因为没有安装GUI,所以很恶心,启动后无法访问,访问提示<code>&quot;Sorry, remote connections (&#39;webAllowOthers&#39;) are disabled on this server&quot;</code></p>
<p><strong>那么注意重点,方法来了:</strong><br>在<code>Windows</code>下配置后,会生成一个属性文件<code>.h2.server.properties</code>,文件位置在<code>&quot;C:\Users\用户目录&quot;</code>,打开该文件可以看到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">#H2 Server Properties</div><div class="line">#Sat Nov 11 17:40:03 CST 2017</div><div class="line">0=Generic JNDI Data Source|javax.naming.InitialContext|java\:comp/env/jdbc/Test|sa</div><div class="line">1=Generic Firebird Server|org.firebirdsql.jdbc.FBDriver|jdbc\:firebirdsql\:localhost\:/temp/firebird/test|sysdba</div><div class="line">10=Generic Derby (Server)|org.apache.derby.jdbc.ClientDriver|jdbc\:derby\://localhost\:1527/test;create\=true|sa</div><div class="line">11=Generic Derby (Embedded)|org.apache.derby.jdbc.EmbeddedDriver|jdbc\:derby\:test;create\=true|sa</div><div class="line">12=Generic H2 (Server)|org.h2.Driver|jdbc\:h2\:tcp\://localhost/~/test|sa</div><div class="line"># 注意此处默认有一个test数据库,数据库位置&quot;d:/opt/h2/data/test&quot;,用户名是test. 如果要移植到Linux下的时候将此处目录修改为在Linux上对应目录即可</div><div class="line">13=Generic H2 (Embedded)|org.h2.Driver|jdbc\:h2\:d\:/opt/h2/data/test|test</div><div class="line">2=Generic SQLite|org.sqlite.JDBC|jdbc\:sqlite\:test|sa</div><div class="line">3=Generic DB2|com.ibm.db2.jcc.DB2Driver|jdbc\:db2\://localhost/test|</div><div class="line">4=Generic Oracle|oracle.jdbc.driver.OracleDriver|jdbc\:oracle\:thin\:@localhost\:1521\:XE|sa</div><div class="line">5=Generic MS SQL Server 2000|com.microsoft.jdbc.sqlserver.SQLServerDriver|jdbc\:microsoft\:sqlserver\://localhost\:1433;DatabaseName\=sqlexpress|sa</div><div class="line">6=Generic MS SQL Server 2005|com.microsoft.sqlserver.jdbc.SQLServerDriver|jdbc\:sqlserver\://localhost;DatabaseName\=test|sa</div><div class="line">7=Generic PostgreSQL|org.postgresql.Driver|jdbc\:postgresql\:test|</div><div class="line">8=Generic MySQL|com.mysql.jdbc.Driver|jdbc\:mysql\://localhost\:3306/test|</div><div class="line">9=Generic HSQLDB|org.hsqldb.jdbcDriver|jdbc\:hsqldb\:test;hsqldb.default_table_type\=cached|sa</div><div class="line"># 允许远程访问</div><div class="line">webAllowOthers=true</div><div class="line"># 访问端口</div><div class="line">webPort=80</div><div class="line">webSSL=false</div></pre></td></tr></table></figure></p>
<p>将<code>.h2.server.properties</code>文件移植到Linux系统下,如果是<code>root</code>,则放在<code>/root</code>目录下即可,其他用户放到<code>/home/用户目录</code>下(没测试过)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">#H2 Server Properties</div><div class="line">#Sat Nov 11 17:58:34 CST 2017</div><div class="line">0=Generic JNDI Data Source|javax.naming.InitialContext|java\:comp/env/jdbc/Test|sa</div><div class="line">1=Generic Firebird Server|org.firebirdsql.jdbc.FBDriver|jdbc\:firebirdsql\:localhost\:/temp/firebird/test|sysdba</div><div class="line">10=Generic Derby (Server)|org.apache.derby.jdbc.ClientDriver|jdbc\:derby\://localhost\:1527/test;create\=true|sa</div><div class="line">11=Generic Derby (Embedded)|org.apache.derby.jdbc.EmbeddedDriver|jdbc\:derby\:test;create\=true|sa</div><div class="line">12=Generic H2 (Server)|org.h2.Driver|jdbc\:h2\:tcp\://localhost/~/test|sa</div><div class="line">13=Generic H2 (Embedded)|org.h2.Driver|jdbc\:h2\:/opt/h2/data/xxx|xxx</div><div class="line">2=Generic SQLite|org.sqlite.JDBC|jdbc\:sqlite\:test|sa</div><div class="line">3=Generic DB2|com.ibm.db2.jcc.DB2Driver|jdbc\:db2\://localhost/test|</div><div class="line">4=Generic Oracle|oracle.jdbc.driver.OracleDriver|jdbc\:oracle\:thin\:@localhost\:1521\:XE|sa</div><div class="line">5=Generic MS SQL Server 2000|com.microsoft.jdbc.sqlserver.SQLServerDriver|jdbc\:microsoft\:sqlserver\://localhost\:1433;DatabaseName\=sqlexpress|sa</div><div class="line">6=Generic MS SQL Server 2005|com.microsoft.sqlserver.jdbc.SQLServerDriver|jdbc\:sqlserver\://localhost;DatabaseName\=test|sa</div><div class="line">7=Generic PostgreSQL|org.postgresql.Driver|jdbc\:postgresql\:test|</div><div class="line">8=Generic MySQL|com.mysql.jdbc.Driver|jdbc\:mysql\://localhost\:3306/test|</div><div class="line">9=Generic HSQLDB|org.hsqldb.jdbcDriver|jdbc\:hsqldb\:test;hsqldb.default_table_type\=cached|sa</div><div class="line">webAllowOthers=true</div><div class="line">webPort=80</div><div class="line">webSSL=false</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/h2/">h2</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <!--
	作者：646759661@qq.com
	时间：2017-10-25
	描述：width: 66%; 变更为 width: 100%;
-->
<article id="post-gitbook/directory"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/11/10/gitbook/directory/">GitBook Read</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/11/10/gitbook/directory/" class="article-date">
	  <time datetime="2017-11-10T01:32:49.868Z" itemprop="datePublished">十一月 10, 2017</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>## </p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GitBook/">GitBook</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <!--
	作者：646759661@qq.com
	时间：2017-10-25
	描述：width: 66%; 变更为 width: 100%;
-->
<article id="post-eat/menu"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/10/25/eat/menu/">这一天天的吃食</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/10/25/eat/menu/" class="article-date">
	  <time datetime="2017-10-25T10:00:09.696Z" itemprop="datePublished">十月 25, 2017</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="2017年10月25日"><a href="#2017年10月25日" class="headerlink" title="2017年10月25日"></a>2017年10月25日</h2><p><a href="http://www.haodou.com/recipe/63370/" target="_blank" rel="external">好豆-炖豆腐</a></p>
<p><a href="http://www.haodou.com/recipe/279668/" target="_blank" rel="external">好豆-宫保鸡</a></p>
<hr>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/eat/">eat</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <!--
	作者：646759661@qq.com
	时间：2017-10-25
	描述：width: 66%; 变更为 width: 100%;
-->
<article id="post-life/economic"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/10/25/life/economic/">经济学理论</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/10/25/life/economic/" class="article-date">
	  <time datetime="2017-10-25T05:42:54.857Z" itemprop="datePublished">十月 25, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/经济/">经济</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="菜单成本"><a href="#菜单成本" class="headerlink" title="菜单成本"></a>菜单成本</h3><p>商家涨价的时候也得花钱.餐厅该价格要重印菜单,重做宣传,安抚抗议的消费者</p>
<h3 id="古诺均衡"><a href="#古诺均衡" class="headerlink" title="古诺均衡"></a>古诺均衡</h3><p>通俗来讲，一种产品市场只有两个卖家，卖的东西基本无差别，两个卖家相互之间也没有任何串通行为,不过都知道对方将生产多少、怎样定价，这样，双方都可以确定最优的产量来实现利润最大化。在这种均衡之下,低价格和微薄的利润，将大部分竞争对手阻挡在行业之外，而少数的巨头则依赖于规模生存下来，获得尚属可观的总量利润。</p>
<p><img src="http://blog.magicpose.com/img/cournotequilibrium.jpg" alt="古诺均衡曲线"></p>
<p><a href="https://www.zhihu.com/question/28670668/answer/249332525" target="_blank" rel="external">知乎:为什么可口可乐涨价幅度不大？</a></p>
<hr>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/经济/">经济</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/economic/">economic</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <!--
	作者：646759661@qq.com
	时间：2017-10-25
	描述：width: 66%; 变更为 width: 100%;
-->
<article id="post-mysql_datetime_count"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/10/01/mysql_datetime_count/">MYSQL按时间统计</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/10/01/mysql_datetime_count/" class="article-date">
	  <time datetime="2017-10-01T14:22:27.899Z" itemprop="datePublished">十月 1, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/MYSQL/">MYSQL</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>以下例子是按照小时和按照日期统计,其他的姿势可以自行切换<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"># 按小时统计</div><div class="line">SELECT  DATE_FORMAT(create_time, &apos;%Y-%m-%d %H&apos;) &apos;月份&apos;,COUNT(*) &apos;出库单数量&apos; FROM erp_warehouse_out</div><div class="line"> WHERE DATE_FORMAT(create_time,&apos;%Y-%m-%d&apos;)=&apos;2017-10-01&apos; GROUP BY DATE_FORMAT(create_time, &apos;%Y-%m-%d %H&apos;);</div><div class="line"> </div><div class="line"># 按日期统计</div><div class="line">SELECT  DATE_FORMAT(create_time, &apos;%Y-%m-%d&apos;) &apos;月份&apos;,COUNT(*) &apos;出库单数量&apos; FROM erp_warehouse_in</div><div class="line"> WHERE create_time&gt;&apos;2017-10-01 01:00:00&apos; GROUP BY DATE_FORMAT(create_time, &apos;%Y-%m-%d&apos;);</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/MYSQL/">MYSQL</a>

      
      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <!--
	作者：646759661@qq.com
	时间：2017-10-25
	描述：width: 66%; 变更为 width: 100%;
-->
<article id="post-redis-info"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/09/26/redis-info/">redis-cli 查看redis性能信息</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/09/26/redis-info/" class="article-date">
	  <time datetime="2017-09-26T07:37:36.037Z" itemprop="datePublished">九月 26, 2017</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="info"><a href="#info" class="headerlink" title="info"></a>info</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">$ redis-cli -h 127.0.0.1 -p 4848 -a <span class="string">'pwd'</span> info </div><div class="line">	| grep -e <span class="string">"connected_clients"</span> -e <span class="string">"blocked_clients"</span> </div><div class="line">	-e <span class="string">"used_memory_human"</span> -e <span class="string">"used_memory_peak_human"</span> </div><div class="line">	-e <span class="string">"rejected_connections"</span> -e <span class="string">"evicted_keys"</span> </div><div class="line">	-e <span class="string">"instantaneous"</span></div><div class="line"></div><div class="line">connected_clients:203</div><div class="line">blocked_clients:0</div><div class="line">used_memory_human:1.45G</div><div class="line">used_memory_peak_human:1.89G</div><div class="line">instantaneous_ops_per_sec:2029</div><div class="line">instantaneous_input_kbps:1646.20</div><div class="line">instantaneous_output_kbps:2149.47</div><div class="line">rejected_connections:0</div><div class="line">evicted_keys:0</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/">redis</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <!--
	作者：646759661@qq.com
	时间：2017-10-25
	描述：width: 66%; 变更为 width: 100%;
-->
<article id="post-java_exception_gc_overhead"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/09/24/java_exception_gc_overhead/">GC overhead limit</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/09/24/java_exception_gc_overhead/" class="article-date">
	  <time datetime="2017-09-24T04:14:56.780Z" itemprop="datePublished">九月 24, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/djava/">JAVA</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>导出excel的时候报错. </p>
<h2 id="异常代码摘要"><a href="#异常代码摘要" class="headerlink" title="异常代码摘要"></a>异常代码摘要</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun </div><div class="line"> java.lang.OutOfMemoryError: GC overhead limit exceeded</div><div class="line">	at org.apache.xmlbeans.impl.store.Saver$SynthNamespaceSaver.&lt;init&gt;(Saver.java:863)</div><div class="line">	at org.apache.xmlbeans.impl.store.Saver.&lt;init&gt;(Saver.java:121)</div><div class="line">	at org.apache.xmlbeans.impl.store.Saver$TextSaver.&lt;init&gt;(Saver.java:896)</div><div class="line">	at org.apache.xmlbeans.impl.store.Cursor._xmlText(Cursor.java:546)</div><div class="line">	at org.apache.xmlbeans.impl.store.Cursor.xmlText(Cursor.java:2436)</div><div class="line">	at org.apache.xmlbeans.impl.values.XmlObjectBase.xmlText(XmlObjectBase.java:1455)</div><div class="line">	at org.apache.poi.xssf.model.SharedStringsTable.getKey(SharedStringsTable.java:130)</div><div class="line">	at org.apache.poi.xssf.model.SharedStringsTable.addEntry(SharedStringsTable.java:176)</div><div class="line">	at org.apache.poi.xssf.usermodel.XSSFCell.setCellValue(XSSFCell.java:345)</div><div class="line">	at org.apache.poi.xssf.usermodel.XSSFCell.setCellValue(XSSFCell.java:315)</div><div class="line">	at com.jfinal.ext.kit.excel.PoiExporter.processAsRecord(PoiExporter.java:199)</div><div class="line">	at com.jfinal.ext.kit.excel.PoiExporter.export(PoiExporter.java:135)</div><div class="line">	at com.jfinal.ext.render.excel.PoiRender.render(PoiRender.java:57)</div><div class="line">	at com.jfinal.core.ActionHandler.handle(ActionHandler.java:99)</div><div class="line">	at org.edaw.report.common.handler.SessionHandler.handle(SessionHandler.java:30)</div><div class="line">	at com.jfinal.core.JFinalFilter.doFilter(JFinalFilter.java:74)</div><div class="line">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)</div><div class="line">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)</div><div class="line">	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:212)</div><div class="line">	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:94)</div></pre></td></tr></table></figure>
<h2 id="原因和解决方案"><a href="#原因和解决方案" class="headerlink" title="原因和解决方案"></a>原因和解决方案</h2><p>jdk的一种预警,表示gc可能发生内存溢出.可修改<code>jdk</code>参数尝试修复</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 修改 catalina.sh 启动参数</span></div><div class="line">JAVA_OPTS=<span class="string">"-server</span></div><div class="line"><span class="string">-Xms6144m</span></div><div class="line"><span class="string">-Xms6144m</span></div><div class="line"><span class="string">-XX:MaxPermSize=1024m -XX:MetaspaceSize=512m</span></div><div class="line"><span class="string">-XX:+UseG1GC</span></div><div class="line"><span class="string">-XX:ParallelGCThreads=6</span></div><div class="line"><span class="string">-XX:NewRatio=2 -XX:ConcGCThreads=4</span></div><div class="line"><span class="string">-XX:MaxGCPauseMillis=300</span></div><div class="line"><span class="string">-XX:InitiatingHeapOccupancyPercent=50 -XX:G1HeapRegionSize=4m -XX:+ExplicitGCInvokesConcurrent</span></div><div class="line"><span class="string">-XX:+PrintGCDetails -Xloggc:/mnt/wwwroot/server/tomcat/gclog/report_tomcat_gc.log"</span></div></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/djava/">JAVA</a>

      
      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <!--
	作者：646759661@qq.com
	时间：2017-10-25
	描述：width: 66%; 变更为 width: 100%;
-->
<article id="post-first"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/09/21/first/">first</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/09/21/first/" class="article-date">
	  <time datetime="2017-09-21T07:01:54.000Z" itemprop="datePublished">九月 21, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/test/">测试</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<blockquote><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque hendrerit lacus ut purus iaculis feugiat. Sed nec tempor elit, quis aliquam neque. Curabitur sed diam eget dolor fermentum semper at eu lorem.</p>
</blockquote>
      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/test/">测试</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/edaw/">edaw</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/test/">test</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/uec/">uec</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
  </nav>

</section>
          <aside id="sidebar">
  
    <div style="margin: 20px 0;">
	<div id="search-form-wrap">

    <form class="search-form">
        <label style="width: 72%;">
            <span class="screen-reader-text">Search for:</span>
            <input type="search" class="search-field" style="height: 36px; width: 100%;" placeholder=" 搜索…" value="" name="s" title="Search for:">
        </label>
        <input type="submit" class="search-form-submit" value="搜索">
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(无标题)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">联系我们</h3>
    <div class="widget widget_athemes_social_icons">

    	<ul class="clearfix widget-social-icons">   
    	
   			<li><a href="https://github.com/iTimeTraveler" title="Github"><i class="fa fa-github" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Weibo"><i class="fa fa-weibo" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Twitter"><i class="fa fa-twitter" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Facebook"><i class="fa fa-facebook" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Google-plus"><i class="fa fa-google-plus" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Instagram"><i class="fa fa-instagram" aria-hidden="true"></i></a></li> 

   		
   		</ul>


   		<!--
   		<ul class="clearfix widget-social-icons">   		
   		<li class="widget-si-twitter"><a href="http://twitter.com" title="Twitter"><i class="ico-twitter"></i></a></li> 
		<li class="widget-si-facebook"><a href="http://facebook.com" title="Facebook"><i class="ico-facebook"></i></a></li>
			<li class="widget-si-gplus"><a href="http://plus.google.com" title="Google+"><i class="ico-gplus"></i></a></li>
			<li class="widget-si-pinterest"><a href="http://pinterest.com" title="Pinterest"><i class="ico-pinterest"></i></a></li>
			<li class="widget-si-flickr"><a href="http://flickr.com" title="Flickr"><i class="ico-flickr"></i></a></li>
			<li class="widget-si-instagram"><a href="http://instagram.com" title="Instagram"><i class="ico-instagram"></i></a></li>
		</ul> -->

    </div>
  </div>


  
    
  <div class="widget_athemes_tabs">
    <ul id="widget-tab" class="clearfix widget-tab-nav">
      <li class="active"><a>最新文章</a></li>
    </ul>
    <div class="widget">
      <ul>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/11/16/jvm/reprint_jstack/">Java jstack 用法</a></h6>
              <span>十一月 16, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/11/13/English/directory/">专业名词解释 1</a></h6>
              <span>十一月 13, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/11/11/h2/install h2/">H2 数据库安装</a></h6>
              <span>十一月 11, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/11/10/gitbook/directory/">GitBook Read</a></h6>
              <span>十一月 10, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/10/25/eat/menu/">这一天天的吃食</a></h6>
              <span>十月 25, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/10/25/life/economic/">经济学理论</a></h6>
              <span>十月 25, 2017</span>
            </div>

          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/djava/">JAVA</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MYSQL/">MYSQL</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/test/">测试</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/经济/">经济</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/English/">English</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GitBook/">GitBook</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/">JVM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eat/">eat</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/economic/">economic</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/edaw/">edaw</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/h2/">h2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/">test</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uec/">uec</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/English/" style="font-size: 10px;">English</a> <a href="/tags/GitBook/" style="font-size: 10px;">GitBook</a> <a href="/tags/JVM/" style="font-size: 10px;">JVM</a> <a href="/tags/eat/" style="font-size: 10px;">eat</a> <a href="/tags/economic/" style="font-size: 10px;">economic</a> <a href="/tags/edaw/" style="font-size: 10px;">edaw</a> <a href="/tags/h2/" style="font-size: 10px;">h2</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/test/" style="font-size: 10px;">test</a> <a href="/tags/uec/" style="font-size: 10px;">uec</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>

    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">6</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2017 Pivot&#39;s Blog All Rights Reserved.
        
            <span id="busuanzi_container_site_uv">
              本站访客数<span id="busuanzi_value_site_uv"></span>人次  
              本站总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>
          
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hipaper" target="_blank">hipaper</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");

    wrapdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";


    <!-- headerblur min height -->
    
    
</script>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>







  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
